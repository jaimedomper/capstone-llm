{
    "title": "How do we define select statement as a variable in dbt?",
    "question_body": "<p>Hi I am trying to define a select statement in a set variable in dbt,\ncan any one suggest how to set sql query as a variable in dbt  and how to access those variables in below CTEs?</p>\n",
    "answer_body": "<p>You can use <code>call statement</code> and get the result in a variable with <code>load_result</code></p>\n<p>Here is an example of retrieving only one field from the select statement:</p>\n<pre><code>{%- call statement('my_statement', fetch_result=True) -%}\n      SELECT my_field FROM my_table\n{%- endcall -%}\n\n{%- set my_var = load_result('my_statement')['data'][0][0] -%}\n</code></pre>\n<p>Then you can use <code>{{ my_var }}</code></p>\n<p>You can play with <code>['data'][0][0]</code> depending on the rows and columns that your select returns</p>\n"
}